## <h1 id="contents">目录</h1>

### [1.前言](#introduction)

### [2.实验内容介绍](#experiment)

  - 2.1 自变量与因变量
  - 2.2 实验范式介绍
  - 2.3 something interesting
### [3.JSPSYCH部分介绍](#jspsych_node)

  - 3.1 框架
  - 3.2 插件
  - 3.3 timeline、事件等扩展功能
  - 3.4 数据收集、修改、保存
### [4.代码部分介绍](#code)

  - 4.1 仓库概述（**老师检查作业可先看这部分**）
  - 4.2 html文件
  - 4.3 css文件
  - 4.4 js文件
***

<h1 id="experiment">1.前言</h1>

- ***实验目的***：本次实验主要有三个目的。
  - 一为完成课程作业，用户体验课程较本科期间的同名课更有实践意义。吴俊老师介绍了许多实践现状，对心理学如何应用于企业、市场做了相当的思考，讲述内容更偏向于企业应用模块，反而是心理学的内容涉及较少。而本科期间用户体验课程的内容的线框图、竞品分析、设计分析反而更偏向于心理学，有点幽默了😂；
  - 二是学习javascript的大概，知道如何将js应用于html，并修改css样式，提高美观程度，本实验主要通过*jspsych*库来编写程序，该库专门应用于编写心理学的程序；
  - 三是试试用另一种方式来编写毕业论文的实验程序，虽然最后不一定会用，但是基于前两个目的，也可以认真做一下，毕竟应该是学生生涯最后的课程任务了。
- ***作业任务要求***：课程作业任务包括五个方面，汇总一下：
  - jspsych
  - flexbox
  - markdown
  - LMM_content
  - git
- ***我做了什么***：
  - LMM_content
    - 翻译了英文实验材料并控制了无关变量
	- 生成一些好看的样式模板，包括等待的点点点
	- 生成一些markdown语句模板，以及本篇文档中的常识性内容
  - Jspsych
    - 使用jspsych库撰写了一个实验，该实验包括了一个字母搜索任务、一个控制过的独裁者范式、一个系列的道德困境判断任务（称之为CNI模型）
	- 使用了多类插件plugin
	- 使用timeline扩展功能
	- 数据的修改、收集、保存
  - Flexbox
    - 字母矩阵使用了flexbox布局，使得每行仅有四个字母块
	- [ ] 单个页面中的多段HTML使用flexbox布局(未完成)，使得有一个头、正文、尾的效果
  - Markdown
    - 撰写本篇帮助文档
  - Git
    - 使用git，完成本地仓库和远端仓库的链接，熟悉了使用git命令利用GitHub中的开源代码
	- 将实验代码上传至GitHub，记录程序撰写过程
	- [ ]未使用branch功能，不需要分支和合作开发，后续可能创建一个Android版的分支
	
[返回目录](#contents)
***
<h1 id="experiment">2.实验内容介绍</h1>

## 2.1 自变量与因变量
>在心理学实验中，变量是逻辑起点，因此将自变量和因变量放在开头，便能理解我这个实验到底想做什么。本文的自变量是***公平感***，因变量是***道德困境判断***，一句话总结便是<u>一个人的公平感是否会影响人在道德困境中的道德判断</u>。这句话所涵盖的哲学内涵非常丰富，一个简单的实验也不可能能够探究这么深的哲学问题，心理学的实验是具体而明确的，是通过操纵性定义来界定概念范畴的。因此，我讨论的公平感界定在“社会公平感”、“结果公平”、“程序公平”这三个方面，道德困境判断也是局限在“功利主义”和“道义论”相竞争的道德困境中的判断。这些概念相应的有实验范式来具体测量，**实验范式**便是心理学所特有的工具。
### 2.1.1 自变量
- 公平是个社会层面的概念，往往和平等、公正、正义等词汇混用，实则是存在差异的。而公平感则是个人面对所遭遇的实际情况，在对比应有情况之下所体验到的综合主观感受，这种体验对人的情感和认知都会造成影响。具体而言，对情绪，公平感会激发快乐，优势不公平感会激发内疚，劣势不公平感会激发愤怒；其次，还对情绪动机也有影响，从而产生趋避行为。对认知，不公平感会造成认知控制三种成分的下降，公平感则会提升认知控制水平等。
- 宏观的公平感使用社会公平感来测量，说明人在日常状态下，对社会公平性的普遍信念，并形成一种相对稳定的感受。微观的公平感选择经典的结果公平、程序公平两个维度。
- 社会公平感有统计学者编制的社会公平感问卷来测量；结果公平和程序公平通常通过独裁者范式来进行操纵，包括对结果、程序规则的控制。
### 2.1.2 因变量
- 道德判断是一种心理过程，尚未涉及行为层面，通常通过自我报告来测量。
- 道德困境指的是当情境中出现两个相互冲突的倾向时，便产生了道德困境。如经典的电车难题，要么遵循道德规范但是会伤害更多的人，要么违反道德规范伤害更少的人，这被描述为“道义论”和“功利主义”的竞争。

<p align = "center"><img src="https://gitee.com/FreonCHY/online-images/raw/master/switch.png" /></p>

- CNI模型：是由Gawrongski于2017年基于MPT（多项式决策树）模型提出的计算道德困境中三个参数C、N、I的方式，是道德心理学领域目前一个较新的计算模型，能够通过简单的自陈二元报告分析得到细微的、具有更深刻内涵的三个参数——结果敏感性、规范敏感性、不行动偏好。

## 2.2 实验范式介绍
### 2.2.1 字母搜索任务
- **字母搜索任务**就像是玩一个简单的找字游戏。想象一下，你面前有一张纸，上面密密麻麻写满了各种字母。你的任务就是快速找出所有的特定字母，比如字母“A”。这个任务听起来简单，但实际上它能帮心理学家了解我们大脑是如何处理信息和集中注意力的。通过看你找字母的速度和准确性，研究人员可以学到很多关于我们认知能力的知识。
<p align = "center"><img src="https://images.wordmint.com/task_1_3f807e_61b9651e.png" alt="task 1 Word Search" height=300 /></p>

- 但是，在本实验中，该字母搜索任务实则是一种***掩饰情节***，模糊实验意图。字母搜索任务可以改成任何一个合作任务，难度较低，创建一个共同积分，以引入独裁者范式分配积分。
### 2.2.2 独裁者范式
- **独裁者范式**是一种心理学实验，它用来研究人们在权力和资源分配中的决策行为，尤其是当一个人拥有决定权时，会如何对待他人。这个实验通常涉及两个人：一个是独裁者，他有权决定如何分配一笔钱；另一个是接收者，只能接受独裁者的决定。
- **接受者与结果公平**：接受者的公平感指的是当一个人处于接受资源分配的位置上时，他们对于分配结果的公正性或合理性的感受。当人们感觉到被公平对待时，他们更有可能感到满意和信任，这有助于建立和维持积极的社会关系。而当公平感受到威胁时，可能会导致不满、愤怒甚至是冲突。
- **程序公平**：研究发现，不仅分配结果的公平与否会影响人的感受；在分配过程中所遵循的规则、程序是否公平也很重要。独裁者范式也可以遵循一种公平的规则分配，也可以按照一种不公平的规则。
- 总结而言，本实验使用字母搜索任务和独裁者范式操纵个体的公平感知，探讨会如何影响道德困境判断？
### 2.2.3 CNI模型
- **定义**：CNI模型是一种用于研究道德困境反应的计算模型。它通过量化对更大利益后果的敏感性（C）、对道德规范的敏感性（N），以及对行动与不行动的普遍偏好（I），来解释人们在面对道德困境时的决策过程。
- **具体流程**：
  - 在介绍一段道德情景后，让被试想象自己是主人公，询问采取行动是否可接受（可接受性判断）？
  - 四类材料示例：
  
  | 禁止性规范<br/>行为的利益大于成本 | 禁止性规范<br/>行为的利益小于成本 | 指令性规范<br/>行为的利益大于成本 | 指令性规范<br/>行为的利益小于成本 |
|---------------------|---------------------|---------------------|---------------------|
| 你是国家的总统。一个在冲突区活动的游击队绑架了你国家的记者，并威胁如果不支付一百万美元的赎金，就要斩首他。该组织将使用赎金购买武器，导致许多人的死亡。国会已批准支付赎金，但你有权否决付款。 | 你是国家的总统。一个在冲突区活动的游击队绑架了你国家的记者，并威胁如果不支付一百万美元的赎金，就要斩首他。该组织将使用赎金为受干旱影响地区的家人购买食品。国会已批准支付赎金，但你有权否决付款。 | 你是国家的总统。一个在冲突区活动的游击队绑架了你国家的记者，并威胁如果不支付一百万美元的赎金，就要斩首他。该组织将使用赎金为受干旱影响地区的家人购买食品。作为总统，你有权批准支付赎金。 | 你是国家的总统。一个在冲突区活动的游击队绑架了你国家的记者，并威胁如果不支付一百万美元的赎金，就要斩首他。该组织将使用赎金购买武器，导致许多人的死亡。作为总统，你有权批准支付赎金。 |
| 在这种情况下否决支付赎金是否可以接受？ | 在这种情况下否决支付赎金是否可以接受？ | 在这种情况下批准支付赎金是否可以接受？ | 在这种情况下批准支付赎金是否可以接受？ |


- **三个参数**：
  - **对更大利益后果的敏感性（Consequence）**：这是指人们在做出道德判断时，考虑的不仅仅是个人的利益，而是整个社会或群体的利益。比如在经典的电车难题中，是否选择牺牲一个人来救五个人，就涉及到对更大利益后果的考虑。
  - **对道德规范的敏感性（Norm）**：这是指人们在做出道德判断时，会考虑是否违反了某些道德规范或原则。比如在同样的电车难题中，是否应该主动采取行动去牺牲一个人，就涉及到对道德规范的考虑。
  - **行动与不行动的普遍偏好（Inaction）**：这是指人们在面对道德困境时，倾向于采取行动还是不采取行动。有些人可能更倾向于采取行动来解决问题，而有些人则可能更倾向于保持现状，不采取任何行动。

## 2.3 something interesting
### 2.3.1 哲学思辨
- 公平是一个社会性的问题，而道德两难困境是一个个人道德问题，近期将公平和道德困境联系在一起的主题是无人驾驶汽车。无人驾驶汽车很有可能会遇上类似的道德难题，那无人驾驶汽车该撞向人少的一方还是撞向人多的一方呢？而更为基础的问题是，个人的公平感是否会影响道义论、功利主义决策，该问题的解决有助于我们探讨何种选择对于社会而言会更加公平，也有助于我们更深入的理解传统道德两难困境的道义论决策的内涵。
### 2.3.2 PSA翻译程序
- ①原始语言到目标语言得到version A；
- ②目标语言到原始语言version B；
- ③翻译员们和协调者比对A、B、原始语言描述的差异并修改得到version C；
- ④对于version C，两个精通目标语言的非学者查看与察觉有不妥处；
- ⑤数据收集机构看看有没有需要修改的地方并与协调者讨论。
#### *翻译控制无关变量提示词*：
- 角色扮演：中英双向翻译大师，道德哲学家和道德心理学家，精通道德困境问题的知识
- 阅读例子：Moral judgment reloaded: a moral dilemma validation study文献作为参考
- 列出所需控制的无关变量：
	> 提示词：下面是几个关键的无关变量，你需要准确理解它们的内涵，因为接下来我需要你翻译英文的道德困境材料，在翻译过程中你要控制这些无关变量，尽量使得他们在所有实验材料中不发生变化。
	 ```无关变量：
	 （1）意图：指的是主人公在困境中所采取行为的意图，一个是故意的、直接的伤害，另一个是作为副作用的、非直接目的的伤害；
	 （2）个人力量：也可理解为伤害的直接性，困境中主人公是否有直接施加力到受害者身上，如推人；
	 （3）行为受益人：参与者是否在某种程度上，从主人公的行为中获益，尽量控制参与者（被试）不受益；
	 （4）伤害的可避免性：伤害或死亡是否可避免，是否有其他可选方法，和故事的真实性、可信度有关。
	 （5）字数
	 （6）表达风格：即在语言表达时，是使用死亡还是拯救，请避免使用此类词汇，而使用客观性的动作。此外也需控制故事描述中的情感词汇。
	 （7）故事背景：要控制言语表达，不要施加任何具有偏见性的背景观念。
	 （8）呈现顺序：即道德行为的意图和结果的程序顺序在实验材料中应保持一致。
	 ```

<h3 id="presentation">2.3.3 CNI材料呈现流程————三段式文本</h3>

- 前两段的文本呈现在同一屏幕上：第一段解释了一般情况，
- 第二段通过按钮添加到前面的屏幕上，提出了包括道德越轨行为在内的可选择的行动过程。
- 第三段屏幕清除了前两个屏幕，由引出参与者道德判断的问题组成。

[返回目录](#contents)
***

<h1 id="jspsych_node">3.JSPSYCH部分介绍</h1>

> 下面从描绘实验流程的框架、描绘试次的插件、补充细节的扩展功能、数据操作四个部分介绍JSPSYCH的使用。
## 3.1 框架
- JSPSYCH库是一个由Josh de Leeuw开发的javaScript库，用于在网页上执行心理学的实验，相比于其他撰写心理学实验的软件Matlab、Psychopy、E-prime，jspsych的显著优势在于能够和HTML兼容，使得页面呈现的美观程度得到显著提升。需要指出的是，由于页面加载需要一定的时间，因而相比于其他更专门的心理学软件，jsPsych有更多的***17***ms的延迟，然而考虑到按键误差就已高达***70***ms左右，因此除非是对时间精度有极高要求的基础性实验，jsPsych在时间精准度上是可接受的。
- 类似于E-prime，jsPsych的框架也是由时间线和时间线上的控件组成的，时间线本身也能做控件，即嵌套。在jsPsych中，控件被称为插件（plugin）。每一个插件的使用需要在html中引入相应的脚本，才能在js部分得以运行成功。为减少仓库中看不懂的成分以及如今网络的普及性，本实验所有脚本的引入都使用的是CDN方法，因此<u>***你需要在连接网络的状态下才能运行成功。***</u>
- 首先通过initJsPsych()初始化，建立实验对象，该函数可以设定多个参数，对整个实验中的内容都会生效。然后自行创建多个plugin，每个plugin中可包含多个试次（trial），plugin相当于一个模块。最后使用.run([plugins])将创建的多个plugin放入主时间线中，run()函数即执行这些plugin。
- 当然，基于js使得我们也可能自由创建字符串、数字、数组、布尔值等多类变量，并将这些变量灵活运用、复用于plugin中。也可创建各类函数、匿名函数封装某些功能。此外，html格式也可放入变量中，浏览器能够解析html的标签并进行渲染，灵活得到我们想要的样式。

## 3.2 插件
- 由上一环节可知，插件部分才是jsPsych的核心部分。本实验主要使用了五类插件，下面做一个简述，还发现了官方文档的一个bug。
  - **Instructions**：指导插件可显示多个页面，每个页面会有上下页按钮，点击按钮可前进后退，用该插件可以组成多个环节的介绍；
  - **Categorize-html**：分类反应，对参与者不同的response会有不同的反馈，用该插件来给参与者字母搜索任务的判断进行正确或错误的反馈；
  - **Survey-html-form**：问卷-HTML-表单插件，提供填写框，让被试输入一些数据，这些数据类型可以是日期、文件、数字等多种类型。本实验使用该插件用于独裁者范式，模拟当来访者是分配者的情况。其实仍然是掩饰情节，是为了让被试相信确实有合作和分配角色，实际被试都被控制为接受者
  - **Html-Keyboard-Response**：按键反应插件是本实验最频繁使用的插件，也是最能广泛使用的插件，显示一段HTML，被试按键做出反应，实验程序会记录被试的按键数据。
  - **Same-different-html**：相同、不同刺激判断。该插件原本是用于判断两个接连出现的刺激是否相同，我的实验中并不需要该功能，但是按照[以往经典流程](#presentation)需要呈现两个页面的文本，因此选用了该插件。该插件特殊之处在于其刺激的标签是stimuli而不是一般的stimulus。其次还发现了[***官方文档的一个错误***](https://www.jspsych.org/v7/plugins/same-different-html/#parameters) 。文档中的参数说明中写到：first_stim_duration和second_stim_duration参数值设为null时，刺激会一直持续到按键后才进行反应，但设为null后刺激仍然只会持续一段时间就消失。去翻该插件的实际js内容后发现，它是判断该参数value>0才会有刺激持续时间，因此**设置为负数**后才会进入另外一种条件，即我们想要的按键后才进行反应。
 
## 3.3 timeline等扩展功能
- **timeline**
  - 插件的原始功能是一个插件仅能存在一个试次，在插件中嵌套使用timeline便可包含多个试次，从理论上讲本实验可以把所有试次放在一个插件中，但是那样的话代码不具有可读性。我的实验将整体分为六个部分，主体是三大环节。
    - 介绍部分
    - 练习部分
    - **环节一：字母搜索任务部分**
    - **环节二：独裁者范式部分**
    - **环节三：CNI——道德困境判断部分**
    - 保存数据部分
  - timeline实现包含多个试次的方式包括手敲每一个试次；也可以使用**timelinevariable**，快速替换某些关键变量，其他则如常。
  - timeline代码模板如下所示：
	```
	let trialname={
		type:'',
		choices:'',
		timeline:[
			{
				stimulus:jsPsych.timelineVariable('content'),
				on_finish:function(){}
			},
		{}],
		timeline_variables:[{content:''},{}],
		loop_function:function(){
			
		}
	}
	```
- **事件功能**：on_finish、on_start、on_load等事件可用任意添加到每个试次、时间线、实验主程序中，当该环节结束、开始、运行时，事件中设定的功能便会执行。
- **循环和条件函数**：在每一个编程语言中，必有的功能肯定包括循环语句和条件语句（while、for、if、else等）。而jsPsych库面向每一个时间线需要不要运行，需不需要循环设置了专门的函数。loop_function和conditional_function仅能应用于timeline中，哪怕仅有一个试次也需要专门设置成timeline，这两个函数才能生效。这两个函数需要接收布尔值，为true时才会执行循环和条件试次，为false时则不执行。

## 3.4 数据的获取、修改、保存
- **数据的获取**：jsPsych.data.get()会返回一个datacolletcion的对象，该对象必然包含的属性是反应按键（response）、反应时（RT）、刺激（stimulus）等。反应时和按键值就是心理学行为实验最重要的指标。后面再加.values()会转换为数组，还有其他方式能筛选包括特定内容的试次，或者筛选所有试次的某一个属性。
- **数据的修改**：
在每一个试次运行时，使用data.propertyname=xxx即可增加或者修改某类属性的值，当然***不是鼓励学术不端***。
- **数据的保存**：数组对象当然可以转换成csv，并人为保存，有需要的时候可以具体操做针对性的保存所需数据。但是jsPsych库为datacollection对象提供了一个.localSave(format,filename)方法，直接保存为指定格式的文件，通常为csv或json。不用多说的便是转换为csv表格后，更好进行操作。



[返回目录](#contents)
***
<h1 id="code">4.代码部分介绍</h1>

> 这部分等同于README.md
## 4.1 仓库概述（老师检查作业可先看这部分）
本仓库记录了用户体验课程作业的实验代码及过程。包括三部分文件：（1）主体：即html、css、js三件套，网页是框架和由js生成的内容，css是样式，js是逻辑和互动。（2）图片：js中所用到的图片，主要用于介绍每个环节。（3）杂件：主要是在学习git的过程中留存的资料。git的学习主要还是通过《github入门与实践》一书进行的。
## 4.2 html文件
html文件主要搭建了一个网页的框架，引入了多个jsPsych库的插件脚本和样式，最后引入了我自己写的css和javascript。
## 4.3 css文件
保存了实验中调整的css样式文件，包括标题、正文、底部按钮或提示词的三段布局样式，特殊按钮样式，字母搜索矩阵样式，等待的点点点动画，文本框样式，etc。
## 4.4 js文件
- 该文件记录了我的具体实验内容，六个部分三大环节的插件设计，各部分的串联，运用扩展功能完善细节。
  - 介绍部分
  - 练习部分
  - **环节一：字母搜索任务部分**
  - **环节二：独裁者范式部分**
  - **环节三：CNI——道德困境判断部分**
  - 保存数据部分
- 使用折叠功能更能看清我的框架，各部分都有注释表明。

[返回目录](#contents)